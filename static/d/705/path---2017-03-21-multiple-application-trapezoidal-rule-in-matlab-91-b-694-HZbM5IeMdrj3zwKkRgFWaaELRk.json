{"data":{"logo":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAf0lEQVQI12P49++f3v///xWBmBuIOYBYigEJQMXEobQ0kpg8EDMxoAOg4HQgzgbiBCB2AeJaIHYE4jAgjgbiFCD2BWI3IG6FymUCcQWUtoWqCwKpARkYBcReQJwF1egBZdcAXQ/ix0MtAmlMB4r5AGkHIA4BskGW5kMdZALESQDh3apPUyViLgAAAABJRU5ErkJggg==","width":400,"height":64,"src":"/static/1642a962a17c5982edb23d2f20e5a8e6/51380/logo.png","srcSet":"/static/1642a962a17c5982edb23d2f20e5a8e6/51380/logo.png 1x,\n/static/1642a962a17c5982edb23d2f20e5a8e6/240c8/logo.png 1.5x,\n/static/1642a962a17c5982edb23d2f20e5a8e6/f5cf3/logo.png 2x,\n/static/1642a962a17c5982edb23d2f20e5a8e6/01d7c/logo.png 3x"}}},"markdownRemark":{"html":"<p>I recently had to implement multi-application trapezoidal rule for some work I was doing. I decided to implement the algorithm in MATLAB, and figured I’d post a tutorial for it, since I know many people struggle with implementing algorithms in code.</p>\n<p>This implementation takes advantage of MATLAB’s built in functions, and as such, requires no loop. This technique is referred to as ‘vectorization’ and in many cases, can speed up your code significantly, as it lets MATLAB take advantage of its built in matrix features, which rely on LAPACK and LINPACK - matrix math libraries that have been hand-optimized for various processor architectures. Pretty cool!</p>\n<p>We’ll build this up in a script so it’s easy to see all of the variables. I often play around with scripts as I’m developing in MATLAB, and encapsulate the code in a function later.</p>\n<p>Step 1: Define Function</p>\n<p>Trapezoidal rule is a method of numerical integration. It’s not a great one, but it is easy to understand. I’ll assume the reader already has an understanding of how to do it.</p>\n<p>Let’s use an anonymous function to contain the specific function we’d like to integrate. This lets us use standard math notation F(x) to fun the function in our code.</p>\n<p>F = @(x) x^3 + 2*x +5;</p>\n<p>Step 2: Setup Integration Variables</p>\n<p>Now we need some variables to contain the start and end points of the integral, and the number of sections we’d like to use in our trap rule.\nstart = 0;\nendpt = 5;\nn = 3;</p>\n<p>We’ll also generate the points to evaluate the function at using the linspace function, which generates a set of n evenly spaced points between start and endpt.</p>\n<p>Also, we’ll generate h, our step width using the points we just calculated.</p>\n<p>points = linspace(start, endpt, n+1);\nh = abs(points(2) - points(1));</p>\n<p>Step 3: Implement Algorithm</p>\n<p>The algorithm for multi application trapezoidal rule is the following:</p>\n<p>We can implement this in MATLAB, using the sum() function as well as the arrayfun() function, which will apply each element of the points array to our anonymous function F. One important note is that the algorithm above has the points zero-indexed. MATLAB arrays use 1-indexing, so we need to add 1 to each subscript of x in the image above.</p>\n<p>int = (h/2) * (F(points(1)) + 2*sum(arrayfun(F, points(2:n))) + F(points(n+1)))</p>\n<p>Step 4: Vectorize</p>\n<p>Right now, we have arrayfun(), which is (likely) one step better than using a loop. Even better would be using full vectorization. To do this, we need to reformat the f function to take vectors. So, we’ll use the much-misunderstood dot operator . ahead of our caret ^ to make the power element-wise. This means the power will be applied to each element of the input vector, which is what we want. It’s not needed in this application, but using the . before multiplication will result in a more robust function as well, so let’s do it to demonstrate.</p>\n<p>f = @(x) x.^3 + 2*x +5;</p>\n<p>The trap expression will now look like this:\nint = (h/2) * (f(points(1)) + 2*sum(f(points(2:n))) + f(points(n+1)));</p>\n<p>Plotting</p>\n<p>Let’s plot the original function at a higher resolution, and plot the trap points we evaluated. I’ll take advantage of linspace again, to plot our “base” function with 30 times more points than n. For small values of n, this will clearly show the points we use in trap rule. For higher n values, it’ll all smush together.</p>\n<p>% plot a high resolution curve of the function and superimpose the trap\n% points\nplot(linspace(start,endpt,n<em>30),f(linspace(start,endpt,n</em>30)))\nhold on\nplot(points, f(points))\ntitle(sprintf(‘Trap Rule n = %i’, n))</p>\n<p>Notice that I used sprintf to display n in the title of the plot. Sprintf is used for formatting data into strings, which is what the title() function takes.</p>\n<p>The Entire Thing</p>\n<p>Here’s the entire script.</p>\n<p>%% Multi application trap rule\n% Richard Arthurs, March 20, 2017\n% Richarthurs.com</p>\n<p>f = @(x) x.^3 + 2*x +5; % Function to integrate</p>\n<p>start = 0;\nendpt = 5;\nn = 3; % number of sections of trap rule\npoints = linspace(start, endpt, n+1);\nh = abs(points(2) - points(1));</p>\n<p>int = (h/2) * (f(points(1)) + 2*sum(f(points(2:n))) + f(points(n+1))) % the integral approximation</p>\n<p>% plot a high resolution curve of the function and superimpose the trap points\nplot(linspace(start,endpt,n<em>30),f(linspace(start,endpt,n</em>30)))\nhold on\nplot(points, f(points))\ntitle(sprintf(‘Trap Rule n = %i’, n))</p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I recently had to implement multi-application trapezoidal rule for some work I was doing. I decided to implement the algorithm in MATLAB, and figured I’d post a tutorial for it, since I know many people struggle with implementing algorithms in code."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This implementation takes advantage of MATLAB’s built in functions, and as such, requires no loop. This technique is referred to as ‘vectorization’ and in many cases, can speed up your code significantly, as it lets MATLAB take advantage of its built in matrix features, which rely on LAPACK and LINPACK - matrix math libraries that have been hand-optimized for various processor architectures. Pretty cool!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We’ll build this up in a script so it’s easy to see all of the variables. I often play around with scripts as I’m developing in MATLAB, and encapsulate the code in a function later."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Step 1: Define Function"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Trapezoidal rule is a method of numerical integration. It’s not a great one, but it is easy to understand. I’ll assume the reader already has an understanding of how to do it."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let’s use an anonymous function to contain the specific function we’d like to integrate. This lets us use standard math notation F(x) to fun the function in our code."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"F = @(x) x^3 + 2*x +5;"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Step 2: Setup Integration Variables"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now we need some variables to contain the start and end points of the integral, and the number of sections we’d like to use in our trap rule.\nstart = 0;\nendpt = 5;\nn = 3;"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We’ll also generate the points to evaluate the function at using the linspace function, which generates a set of n evenly spaced points between start and endpt."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Also, we’ll generate h, our step width using the points we just calculated."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"points = linspace(start, endpt, n+1);\nh = abs(points(2) - points(1));"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Step 3: Implement Algorithm"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The algorithm for multi application trapezoidal rule is the following:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We can implement this in MATLAB, using the sum() function as well as the arrayfun() function, which will apply each element of the points array to our anonymous function F. One important note is that the algorithm above has the points zero-indexed. MATLAB arrays use 1-indexing, so we need to add 1 to each subscript of x in the image above."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"int = (h/2) * (F(points(1)) + 2*sum(arrayfun(F, points(2:n))) + F(points(n+1)))"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Step 4: Vectorize"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Right now, we have arrayfun(), which is (likely) one step better than using a loop. Even better would be using full vectorization. To do this, we need to reformat the f function to take vectors. So, we’ll use the much-misunderstood dot operator . ahead of our caret ^ to make the power element-wise. This means the power will be applied to each element of the input vector, which is what we want. It’s not needed in this application, but using the . before multiplication will result in a more robust function as well, so let’s do it to demonstrate."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"f = @(x) x.^3 + 2*x +5;"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The trap expression will now look like this:\nint = (h/2) * (f(points(1)) + 2*sum(f(points(2:n))) + f(points(n+1)));"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Plotting"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let’s plot the original function at a higher resolution, and plot the trap points we evaluated. I’ll take advantage of linspace again, to plot our “base” function with 30 times more points than n. For small values of n, this will clearly show the points we use in trap rule. For higher n values, it’ll all smush together."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"% plot a high resolution curve of the function and superimpose the trap\n% points\nplot(linspace(start,endpt,n"},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"30),f(linspace(start,endpt,n"}]},{"type":"text","value":"30)))\nhold on\nplot(points, f(points))\ntitle(sprintf(‘Trap Rule n = %i’, n))"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Notice that I used sprintf to display n in the title of the plot. Sprintf is used for formatting data into strings, which is what the title() function takes."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The Entire Thing"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Here’s the entire script."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"%% Multi application trap rule\n% Richard Arthurs, March 20, 2017\n% Richarthurs.com"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"f = @(x) x.^3 + 2*x +5; % Function to integrate"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"start = 0;\nendpt = 5;\nn = 3; % number of sections of trap rule\npoints = linspace(start, endpt, n+1);\nh = abs(points(2) - points(1));"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"int = (h/2) * (f(points(1)) + 2*sum(f(points(2:n))) + f(points(n+1))) % the integral approximation"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"% plot a high resolution curve of the function and superimpose the trap points\nplot(linspace(start,endpt,n"},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"30),f(linspace(start,endpt,n"}]},{"type":"text","value":"30)))\nhold on\nplot(points, f(points))\ntitle(sprintf(‘Trap Rule n = %i’, n))"}]}],"data":{"quirksMode":false}},"excerpt":"I recently had to implement multi-application trapezoidal rule for some work I was doing. I decided to implement the algorithm in MATLAB…","timeToRead":3,"frontmatter":{"title":"CubeSat Computing Boards","userDate":"21 March 2017","date":"2017-03-21T00:00:00.000Z","tags":["MATLAB","tutorial","programming","engineering","Blog-post"],"image":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAG+AD//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAE/IV//2gAMAwEAAgADAAAAEPPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGBAAAwEBAAAAAAAAAAAAAAAAAAEhEGH/2gAIAQEAAT8QREIvN//Z","aspectRatio":1.4799154334038056,"src":"/static/51b119f8702c088968b5290a8e434baa/a7a5f/matlab-trap-1.jpg","srcSet":"/static/51b119f8702c088968b5290a8e434baa/a7a5f/matlab-trap-1.jpg 700w","sizes":"(max-width: 700px) 100vw, 700px"}}},"author":{"id":"Richard","bio":"Mechatronics Systems engineering student passionate about space, interested in high-reliability embedded systems and computer vision. Currently turning coffee into CubeSats and drones.","avatar":{"children":[{"__typename":"ImageSharp","fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAIDBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAP/aAAwDAQACEAMQAAAB589OeKWwkKgbQn//xAAbEAACAwADAAAAAAAAAAAAAAABAgASIREiMf/aAAgBAQABBQKE9YzUFt5h1V0n3//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/ASE//8QAFREBAQAAAAAAAAAAAAAAAAAAESD/2gAIAQIBAT8BY//EABoQAAICAwAAAAAAAAAAAAAAAAABESEQIDH/2gAIAQEABj8CFHcUrJ1//8QAGhABAAMBAQEAAAAAAAAAAAAAAQARIUExEP/aAAgBAQABPyG1c2E0Ipg9xPQFJ35HtxipKNj1P//aAAwDAQACAAMAAAAQkxCD/8QAGBEAAgMAAAAAAAAAAAAAAAAAABEBECH/2gAIAQMBAT8Q0xkK/8QAGBEAAgMAAAAAAAAAAAAAAAAAAAEQEUH/2gAIAQIBAT8Qs4WiP//EABwQAQADAAMBAQAAAAAAAAAAAAEAESExQXFhkf/aAAgBAQABPxCgAp6NYEcIGjV7i+0/kFpV61wTiYFlNYhBTUGAHzHlQFSFqER9qn//2Q==","width":400,"height":400,"src":"/static/a2b7322425489e49016cd6942dbb87ef/2e811/richard.jpg","srcSet":"/static/a2b7322425489e49016cd6942dbb87ef/2e811/richard.jpg 1x"}}]}}}},"relatedPosts":null},"pageContext":{"slug":"/2017/03/21/multiple-application-trapezoidal-rule-in-matlab/","prev":{"excerpt":"I bought a Raspberry Pi nearly a year ago, always intending to use it in OpenCV experiments. Just recently, I got around to starting the…","timeToRead":4,"frontmatter":{"title":"Getting Started With OpenCV and Raspberry Pi","tags":["openCV","camera","raspberry pi","UART","linux","embedded","Blog-post"],"date":"2017-08-20T00:00:00.000Z","image":{"childImageSharp":{"fluid":{"aspectRatio":1.8041237113402062,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAQD/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQAC/9oADAMBAAIQAxAAAAGDKhliDf/EABkQAAMAAwAAAAAAAAAAAAAAAAABAhESMf/aAAgBAQABBQJSkPXAy+n/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPwFn/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGBAAAwEBAAAAAAAAAAAAAAAAARAhMQD/2gAIAQEABj8CvQPBi//EABoQAQACAwEAAAAAAAAAAAAAAAEAERAhUaH/2gAIAQEAAT8h2A8jWwMrChUA5Mf/2gAMAwEAAgADAAAAEGAP/8QAFhEBAQEAAAAAAAAAAAAAAAAAAREQ/9oACAEDAQE/EBG5/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8QGf/EABoQAQEBAAMBAAAAAAAAAAAAAAERACExYVH/2gAIAQEAAT8QoUAes3LjvIuIEhPiYgMgwTm+Gd//2Q==","sizes":"(max-width: 700px) 100vw, 700px","src":"/static/d6ff0611eb89472cc463867050e13d5b/a7a5f/raspi-opencv-1-1.jpg","srcSet":"/static/d6ff0611eb89472cc463867050e13d5b/a7a5f/raspi-opencv-1-1.jpg 700w"}}},"author":{"id":"Richard","bio":"Mechatronics Systems engineering student passionate about space, interested in high-reliability embedded systems and computer vision. Currently turning coffee into CubeSats and drones.","avatar":{"children":[{"fixed":{"src":"/static/a2b7322425489e49016cd6942dbb87ef/2e811/richard.jpg"}}]}}},"fields":{"layout":"","slug":"/2017/08/20/getting-started-with-opencv-and-raspberry-pi/"}},"next":null,"primaryTag":""}}